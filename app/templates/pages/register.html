{% extends "base.html" %}

{% block title %}Register - Semptify{% endblock %}

{% block extra_styles %}
<style>
    .mt-top { margin-top: 2rem; }
    .grid-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .flex-row-gap { display: flex; gap: 0.5rem; }
    .flex-1 { flex: 1; }
    .full-width { width: 100%; }
    .location-status { display: none; }
</style>
{% endblock %}

{% block content %}
<div class="container container--narrow">
    <div class="card mt-top">
        <div class="text-center mb-xl">
            <h1>üìã Create Your Account</h1>
            <p class="text-secondary mt-sm">
                Get started with Semptify's tenant rights protection tools.
            </p>
        </div>
        
        <form action="/register" method="POST" id="register-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            
            <div class="form-group">
                <label class="form-label" for="first_name">First Name *</label>
                <input type="text" class="form-input" id="first_name" name="first_name" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="last_name">Last Name *</label>
                <input type="text" class="form-input" id="last_name" name="last_name" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="email">Email Address *</label>
                <input type="email" class="form-input" id="email" name="email" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="phone">Phone Number</label>
                <input type="tel" class="form-input" id="phone" name="phone" placeholder="(555) 555-5555">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="address">Street Address *</label>
                <input type="text" class="form-input" id="address" name="address" required placeholder="123 Main St">
            </div>
            
            <div class="grid-2col">
                <div class="form-group">
                    <label class="form-label" for="city">City *</label>
                    <input type="text" class="form-input" id="city" name="city" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="state">State *</label>
                    <div class="flex-row-gap">
                        <select class="form-select flex-1" id="state" name="state" required>
                            <option value="">Select...</option>
                            <option value="MN" selected>Minnesota</option>
                            <option value="WI">Wisconsin</option>
                            <option value="IA">Iowa</option>
                            <option value="SD">South Dakota</option>
                        </select>
                        <button type="button" class="btn btn--secondary btn--sm" onclick="LocationDetect.refresh()" title="Detect my location">
                            üìç
                        </button>
                    </div>
                    <small id="location-status" class="text-muted location-status"></small>
                </div>
            </div>
            
            <div class="grid-2col">
                <div class="form-group">
                    <label class="form-label" for="zip">ZIP Code *</label>
                    <input type="text" class="form-input" id="zip" name="zip" required pattern="[0-9]{5}" maxlength="5">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="county">County</label>
                    <input type="text" class="form-input" id="county" name="county" placeholder="e.g., Hennepin">
                </div>
            </div>
            
<div class="alert alert--info mb-lg">
                <strong>üìç Why we need your address:</strong>
                Your location helps us provide state-specific tenant rights information and connect you with local resources.
                <br><small>Semptify is optimized for Minnesota tenant rights. Other states have limited support.</small>
            </div>

            <button type="submit" class="btn btn--primary btn--lg full-width">
                Create My Account
            </button>
        </form>

        <!-- Location Detection Script -->
        <script src="/static/js/location-detect.js"></script>
        <script>
            LocationDetect.init({
                stateSelectId: 'state',
                countyInputId: 'county',
                cityInputId: 'city',
                zipInputId: 'zip',
                onDetected: function(location) {
                    const statusEl = document.getElementById('location-status');
                    if (statusEl) {
                        statusEl.style.display = 'block';
                        statusEl.textContent = LocationDetect.getSupportMessage(location.state);
                    }
                },
                onError: function(error) {
                    console.log('Location detection unavailable, defaulting to Minnesota');
                }
            });
        </script>        <div class="text-center mt-lg text-muted text-sm">
            By registering, you agree to our <a href="/terms">Terms of Service</a> 
            and <a href="/privacy">Privacy Policy</a>.
        </div>
    </div>
</div>
{% endblock %}
